
<!--
    tipo
    queCalcular
    isKnown
-->

<!-- 
    <form id="formulario" method="POST" action="/upload" enctype="multipart/form-data">
    <input id="file-upload1" type="file" class="inputfile" name="file" />
-->                
<form id="formulario" method="POST" action="/archivo" enctype="multipart/form-data">
<div class="container p-4 col-md-5">
    <div class ="row">
        <div class="card mb-4">
        <div class="col-md-12 mx-auto">
                <div class="card-body">

                    <!-- Tipo -->
                    <div class="input-group">
                        <label for="validationCustom04" class="input-group-text" for="inputGroupSelect01">Tipo</label>
                        <select id="tipo" class="form-select" id="inputGroupSelect01" name="tipo">
                            <option disabled selected>Elegir...</option>
                            <option value="media">Poblacional</option>
                            <option value="total">Total</option>
                            <option value="proporcion">Proporcional</option>
                        </select>
                    </div>                    
                </div>
        </div>

    <div class="col-md-12 mx-auto">
        <div class="">
            <div class="card-body">
                <!-- Calcular que -->
                <div id="calcular" class="input-group">
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-12 mx-auto">
        <div class="">
            <div class="card-body">
                <!-- Varianza conocida¿? -->
                <div id="varianza" class="input-group mb-3">
                </div>
            </div>
        </div>
    </div>
    </div>


    <input id="file-upload1" type="file" class="inputfile" name="file" required/>

    <button onclick="ingresarDatos()" type="button" class="mb-4 btn btn-primary" >Ingresar Datos</button>

    <div class="col-md-12 mx-auto mb-5" id="datosArea">
        <div class="card">
            <div class="card-body">
                <div id="areaDatos" >
                </div>
            </div>
        </div>
    </div>

    <div id="buttonArea" class="d-grid gap-2">

    </div>

    

    </div>
    </div>
 </form>


 <script>

    const tipo = document.getElementById("tipo");


    //Si selecciono algo diferente a la muestra debo elegir que quiero calcular
    tipo.addEventListener('change', () => {
        const lugarBoton = document.getElementById('buttonArea')
        while(areaDatos.firstChild){
            areaDatos.removeChild(areaDatos.lastChild);
        }
         while(lugarBoton.firstChild){
            lugarBoton.removeChild(lugarBoton.lastChild);
        }

        const calcularSelect = document.getElementById("calcular");
        while(calcularSelect.firstChild){
            calcularSelect.removeChild(calcularSelect.lastChild);
        }
        const varianza = document.getElementById("varianza");
        while(varianza.firstChild){
            varianza.removeChild(varianza.lastChild);
        }
        if(tipo.value !== 'muestra'){

            const select = document.createElement("select");
            select.setAttribute('name','queCalcular')
            select.setAttribute("id","queCalcular");
            select.setAttribute("class","form-select")

            const label1 = document.createElement('label');
            const textlabel1 = document.createTextNode('Calcular')
            label1.appendChild(textlabel1)
            label1.setAttribute('class','input-group-text')

            //Agregar opciones
            const option = document.createElement("option");
            const text = document.createTextNode("Promedio");
            option.setAttribute("value","promedio")
            option.appendChild(text)
            select.appendChild(option)

            const option2 = document.createElement("option");
            const text2 = document.createTextNode("Varianza");
            option2.setAttribute("value","varianza")
            option2.appendChild(text2)
            select.appendChild(option2)

            const option3 = document.createElement("option");
            const text3 = document.createTextNode("Cota");
            option3.setAttribute("value","cota")
            option3.appendChild(text3)
            select.appendChild(option3)

            const option4 = document.createElement("option");
            const text4 = document.createTextNode("Tamaño de muestra");
            option4.setAttribute("value","muestra")
            option4.appendChild(text4)
            select.appendChild(option4)

            calcularSelect.appendChild(label1);
            calcularSelect.appendChild(select);
            

            const queCalcular = document.getElementById("queCalcular");

            queCalcular.addEventListener('change', () => {
                while(varianza.firstChild){
                    varianza.removeChild(varianza.lastChild);
                }
                while(areaDatos.firstChild){
                    areaDatos.removeChild(areaDatos.lastChild);
                }
                 while(lugarBoton.firstChild){
            lugarBoton.removeChild(lugarBoton.lastChild);
        }


                if(queCalcular.value !== 'promedio' & queCalcular.value !== 'muestra'){
                    const select2 = document.createElement("select");
                    select2.setAttribute('name','isKnown');
                    select2.setAttribute('id','isKnown');
                    select2.setAttribute("class","form-select")

                    const label2 = document.createElement('label');
                    const textlabel2 = document.createTextNode('¿Conoces la varianza?')
                    label2.appendChild(textlabel2)
                    label2.setAttribute('class','input-group-text')


                    //Agregar opciones
                    const optionY = document.createElement("option");
                    const textY = document.createTextNode("Si");
                    optionY.setAttribute("value","known");
                    optionY.appendChild(textY)
                    select2.appendChild(optionY)

                    const optionN = document.createElement("option");
                    const textN = document.createTextNode("No");
                    optionN.setAttribute("value","unknown");
                    optionN.appendChild(textN)
                    select2.appendChild(optionN);

                    varianza.appendChild(label2)
                    varianza.appendChild(select2);
                    

                    varianza.addEventListener('change', () => {
                        while(areaDatos.firstChild){
                            areaDatos.removeChild(areaDatos.lastChild);
                        }
                         while(lugarBoton.firstChild){
            lugarBoton.removeChild(lugarBoton.lastChild);
        }

                    })
                }
            });
        }else{

        }
    });


    //Ingresar Datos

    const casos = {
        'media':{
            'known': ['varianza', 'N'],
            'unknown': ['varianza', 'N'],
            'promedio': [],
            'muestra': ['cota','N']
        },
        'total':{
            'known': ['N'],
            'unknown': ['N'],
            'promedio': ['N'],
            'muestra': ['cota','N']
        },
        'proporcion':{
            'known': ['p','N'],
            'unknown':['p','q','N'],
            'promedio': [],
            'muestra': ['cota','N','p','q']
        }
    }
    const ingresarDatos = function(){

        const tipo = document.getElementById('tipo');
        let datosNecesarios = []

        if(tipo.value!=='Elegir...'){
            const areaDatos = document.getElementById('datos');
            const tipo = document.getElementById('tipo');

            if(tipo.value!=='muestra'){
                const queCalcular = document.getElementById('queCalcular');
                
                if(queCalcular.value!=='promedio' & queCalcular.value !== 'muestra'){
                    const isKnown = document.getElementById('isKnown');
                    datosNecesarios = casos[tipo.value][isKnown.value]

                }else if(queCalcular.value==='promedio'){
                    datosNecesarios = casos[tipo.value]['promedio']
                }else{
                    datosNecesarios = casos[tipo.value]['muestra']
                }
            }else{
                datosNecesarios = ['N','cota'];
            }
        }

        const areaDatos = document.getElementById('areaDatos');
        const inputs = crearInputs(datosNecesarios);

        while(areaDatos.firstChild){
            areaDatos.removeChild(areaDatos.lastChild);
        }
        
        const lugarBoton = document.getElementById('buttonArea')
        while(lugarBoton.firstChild){
            lugarBoton.removeChild(lugarBoton.lastChild);
        }

        inputs.forEach( input => areaDatos.appendChild(input))


        const lugarcito = document.getElementById('datosArea');

        const crearBoton = document.createElement('button');
    
        crearBoton.setAttribute('type','submit');
        const text = document.createTextNode('Calcular');
        crearBoton.appendChild(text);
        crearBoton.setAttribute('class','mb-4 btn btn-success');
        crearBoton.setAttribute('id','enviar')

        lugarBoton.appendChild(crearBoton)
    }

const crearInputs = function(array){
    let elementos = [];
    array.forEach( (elemento) => {
        let input = document.createElement('input');
        let div = document.createElement('div');
        let label = document.createElement('label')
        let text = document.createTextNode(elemento)
        label.appendChild(text)
        label.setAttribute('class','form-label')
        div.setAttribute('class','form-group mb-3')

        input.setAttribute('name',elemento)
        input.setAttribute('required','true')
        input.setAttribute('class','form-control')
        input.setAttribute('type','number')
        div.appendChild(label)
        div.appendChild(input)
        elementos.push(div)
    })
    return elementos
}




//MEDIA
    //known (varianza, N, n)
    //unknown (varianza, N, n)
    //promedio (suma, totalElementos)


//TOTAL
    //known (varianza, N, n)
    //unknown (varianza, N, n)
    //total (promedio, totalElementos)

//PROPORCION
    //known (p, N, n)
    //unknown (p, q, N, n)
    //promedio (suma, totalElementos)    




 </script>